<audio id="audio_c"></audio>
<div class="arow" style="opacity: 0.4">
  <div style="font-size: 1rem; color: grey">{{语音音节}}</div>
  <div style="font-size: 0.6rem">{{US}}</div>
  <div style="font-size: 0.6rem">{{UK}}</div>
</div>
<div
  style="
    text-align: left;
    display: flex;
    align-items: baseline;
    justify-content: space-between;
  "
>
  <div id="dc" style="margin-top: 0; margin-bottom: 0; opacity: 0.4">
    {{单词}}
  </div>
  <div style="margin-top: 0; margin-bottom: 0">{{单词音频}}</div>
</div>
<div id="sy" style="opacity: 0.25">
  {{释义}}
  <div id="dictTJF"></div>
</div>
<div style="opacity: 0.85">
  <div id="tyj_card">
    <span id="tyj_sent">{{同义短句}}</span>
    <span id="tyj_trans" style="display: none">{{同义释义}}</span>
  </div>
</div>
<hr />
<div class="locat" style="opacity: 0.4">
  重要性：{{重要程度}}， {{所在组}} - {{序号}}
</div>
<div class="center-screen">
  <div id="q_sentence">{{q_sentence}}</div>
  <div style="opacity: 0.3">{{a_sentence}}</div>
</div>
<script>
  var strTJF = `{{SA}}`;
  var tjfs_div = document.getElementById("dictTJF");
  var dictTJF = JSON.parse(strTJF.replace(/'/g, '"'));
  // 使用map和join方法创建链接字符串
  var TJFHTML = `<span class="antonyms">${dictTJF["synonyms"].join(
    ", "
  )}</span><br>`;
  tjfs_div.innerHTML = TJFHTML;
</script>
<script>
  var tyj_card = document.getElementById("tyj_card");
  var tyj_trans = document.getElementById("tyj_trans");
  var is_show_trans = false;

  // 为div添加点击事件监听器
  tyj_card.addEventListener("click", function () {
    if (is_show_trans) {
      tyj_trans.style.display = "none";
    } else {
      tyj_trans.style.display = "inline-block";
    }
    is_show_trans = !is_show_trans;
  });
</script>
<script>
  function setupPronunciationButtons(type, selector, targetSelector) {
    document.querySelectorAll(selector).forEach((button) => {
      button.addEventListener("click", () => {
        const target = document.querySelector(targetSelector).textContent;
        if (type === "us") {
          playAudio({
            target: target,
            language: "English (United States)",
            voice: "en-US-AvaMultilingualNeural",
          });
        } else if (type === "uk") {
          playAudio({
            target: target,
            language: "English (United Kingdom)",
            voice: "en-GB-SoniaNeural",
          });
        }
      });
    });
  }

  function playAudio({ target, language, voice }) {
    const audio = document.querySelector("#audio_c");
    let request_params = "";
    const params = {
      language: language,
      voice: voice,
      text: encodeURIComponent(target),
      role: 0,
      style: 0,
      styledegree: 1,
      volume: 75,
      predict: 0,
      rate: 0,
      pitch: 0,
      kbitrate: "audio-16khz-32kbitrate-mono-mp3",
      yzm: 202410170001,
    };
    for (const [name, value] of Object.entries(params)) {
      request_params = request_params + `${name}=${value}&`;
    }
    request_params = request_params.slice(0, request_params.length - 1);

    fetch(
      "https://proxy.cors.sh/" + "https://www.text-to-speech.cn/getSpeek.php",
      {
        method: "POST", // 指定请求方法
        headers: {
          "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8",
        },
        body: request_params,
      }
    )
      .then((response) => response.json())
      .then((data) => {
        console.log(data);
        audio.src = data.download;
        audio.play();
        audio.addEventListener("ended", function () {
          audio.src = "";
          console.log("音频播放完毕");
        });
      })
      .catch((error) => console.error("Error:", error));
  }

  setupPronunciationButtons("us", ".yinbiao_Only .us", ".word_c");
  setupPronunciationButtons("uk", ".yinbiao_Only .uk", ".word_c");
  setupPronunciationButtons("us", "#q_sentence", "#q_sentence");
</script>
<!--<script>-->
<!--    function setupPronunciationButtons(selector, type, targetSelector) {-->
<!--        document.querySelectorAll(selector).forEach(button => {-->
<!--            button.addEventListener('click', () => {-->
<!--                const target = document.querySelector(targetSelector).textContent;-->
<!--                playAudio(target, type);-->
<!--            });-->
<!--        });-->
<!--    }-->
<!--    function playAudio(target, type) {-->
<!--        const audio = document.querySelector('#audio_c');-->
<!--        audio.src = `https://dict.youdao.com/dictvoice?audio=white&type=${type}`;-->
<!--        audio.play();-->
<!--    }-->
<!--    setupPronunciationButtons('#q_sentence', 1, '#q_sentence');-->
<!--</script>-->
